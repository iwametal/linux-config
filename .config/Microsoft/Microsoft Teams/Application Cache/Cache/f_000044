webpackJsonp([17],{2355:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(237),n(241),n(243),n(242),n(244),n(238),n(239),n(240),n(37),n(245)},2356:function(e,t){e.exports='<div class="ts-adaptive-card card-acc-border" data-tid="{{::ctrl.dateTid}}" tabindex="-1" track-click-silent="true">\n\n  \x3c!--\n    Additional layer of wrapper element for card border is required for card copy & paste\n    (If border is at the most top level, pasting would be broken in OWA)\n  --\x3e\n  <div class="card-border-placeholder">\n    <div class="card-header" ng-show="!ctrl.showCardOverflowActions">\n      \x3c!-- App attribution --\x3e\n      <div class="card-app-attribution"></div>\n\n      <div class="card-header-buttons">\n        \x3c!-- Collapse button --\x3e\n        <button class="hide ts-sym card-collapse app-icons-fill-hover" tabindex="-1">\n          <ng-include src="\'svg/icons-collapse.html\'"></ng-include>\n        </button>\n\n        \x3c!-- Close button --\x3e\n        <button class="hide ts-sym card-close app-icons-fill-hover" tabindex="-1">\n          <ng-include src="\'svg/icons-close.html\'"></ng-include>\n        </button>\n\n        \x3c!-- Copy button --\x3e\n        <button class="hide ts-sym power-bar-card-copy app-icons-fill-hover" tabindex="-1">\n          <ng-include src="\'svg/icons-copy.html\'"></ng-include>\n        </button>\n\n        \x3c!-- Header button --\x3e\n        <button class="hide ts-sym card-header-button card-header app-icons-fill-hover focus-round-border" tabindex="-1" title="{{ctrl.cardHeaderTitle}}" ng-click="ctrl.handleCardHeaderMenu($event)">\n          <ng-include src="\'svg/icons-more.html\'"></ng-include>\n        </button>\n      </div>\n    </div>\n    <div class="card-overflow-actions" ng-if="ctrl.showCardOverflowActions">\n      <div class="card-overflow-buttons">\n        \x3c!-- Overflow action button --\x3e\n        <button class="ts-sym card-overflow-button card-overflow-actions app-icons-fill-hover focus-round-border" tabindex="-1" title="{{ctrl.cardHeaderTitle}}" ng-click="ctrl.handleOverflowActionsMenu($event)">\n          <ng-include src="\'svg/icons-more.html\'"></ng-include>\n        </button>\n      </div>\n    </div>\n\n    \x3c!-- Adaptive card body --\x3e\n    <div class="card-body"></div>\n\n    \x3c!-- Feedback --\x3e\n    <div class="action-feedback">\n        <ng-include src="\'svg/icons-error-small.html\'"></ng-include>\n        <span class="error-text"></span>\n    </div>\n  </div>\n</div>\n'},2357:function(e,t){e.exports='<div class="card-header-menu popover minwidth-sm maxwidth-common app-default-menu" data-tid="cardHeaderMenu" ng-keydown="ctrl.handleMenuKeyDown($event)" id="cardHeaderMenu">\n     <div class="scroll-container">\n      <div class="simple-scrollbar" simple-scrollbar>\n        <div>\n          <ul acc-role="menu" class="app-default-menu-ul">\n            <li class="card-header-menu-items">\n              <button tabindex="-1" ng-click="ctrl.handleOnCopy($event)" class="ts-sym card-header-button" title="{{::$root.resources.strings.icons_copy|translate}}" acc-role="menu-item focus-default" do-not-decorate-click-for-acc>\n                <ng-include src="\'svg/icons-copy.html\'"></ng-include>\n                <span class="ts-popover-label" translate-once="{{::$root.resources.strings.botcards_card_header_menu_copy_option}}"></span>\n             </button>\n             <button tabindex="-1" ng-click="ctrl.handleAppInstall($event)" class="ts-sym card-header-button" ng-if="ctrl.showAppDetails" title="{{::$root.resources.strings.icons_apps|translate}}" acc-role="menu-item focus-default" do-not-decorate-click-for-acc>\n              <ng-include src="\'svg/icons-apps.html\'"></ng-include>\n              <span class="ts-popover-label" translate-once="{{::$root.resources.strings.botcards_card_header_menu_app_details_option}}"></span>\n            </button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n</div>'},2358:function(e,t){e.exports='<div class="card-overflow-menu popover minwidth-sm maxwidth-common app-default-menu" data-tid="cardOverflowMenu" ng-keydown="ctrl.handleMenuKeyDown($event)" id="cardOverflowMenu">\n     <div class="scroll-container">\n      <div class="simple-scrollbar" simple-scrollbar>\n        <div>\n          <ul acc-role="menu" class="app-default-menu-ul">\n              <li class="card-overflow-menu-items" ng-repeat="action in ctrl.overflowActions">\n                <button tabindex="-1" ng-click="ctrl.handleOnExecuteAction(action)" class="ts-sym card-overflow-button" title="{{::action.title}}" acc-role="menu-item focus-default" do-not-decorate-click-for-acc>\n                  <img ng-src="{{::action.iconUrl}}" class="card-overflow-icon"/>\n                  <span class="ts-popover-label" translate-once="{{::action.title}}"></span>\n              </button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n</div>\n'},237:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&(n[i[r]]=e[i[r]]);return n};Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),o=n(5),s=n(2356),c=n(2357),l=n(2358),d=n(14),p=n(76),u=n(37),h=n(245),m=n(67),f=function(e){function t(t,n,i,r,a,o,s,c,l,p,u,h,m,f,g,v,b,y,C,S,w,x,$,A,k,T,E,I){var O=e.call(this,t,n,i,r,I)||this;return O.$scope=r,O.$element=a,O.$compile=o,O.$window=s,O.$cookies=c,O.$translate=l,O.$templateCache=p,O.$timeout=u,O.constants=h,O.localizationService=m,O.ariaLiveService=f,O.botCardFactory=v,O.htmlSanitizer=b,O.resources=y,O.loggingService=C,O.utilityService=S,O.settingsService=w,O.tooltipService=x,O.tooltipCssApplicators=$,O.appsService=A,O.dialogService=k,O.semanticObjectService=T,O.htmlMessageBodyAdapterService=E,O.cardHeaderTitle="",O.overflowActions=[],O.showCardOverflowActions=!1,O.cardBodyClass="card-body",O.cardBorderClass="card-border",O.cardResponsiveWidthClass="adaptive-card-responsive",O.clientObservers={},O.defaultFontSizeAndFontWeightPayload={fontFamily:'"Segoe UI", "Helvetica Neue", "Apple Color Emoji", "Segoe UI Emoji", Helvetica, Arial, sans-serif',fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:300,default:400,bolder:600}},O.processMarkDown=function(e,t){var n=O.markdownIt.render(e);O.isAtMentionsEnabledInAdaptiveCards&&(n=O.populateAtMentionsSemanticObjects(e,n));var i=O.htmlSanitizer.sanitizeHtml(n);return t.didProcess=!0,t.outputHtml=i,i},O.logger=C.newLogger("AdaptiveCardController"),O.objectId=S.generateUUIDNormalized(),O.cardHeaderMenuId=S.generateUUID(),O.cardHeaderTitle=l.instant(y.strings.botcards_card_header_menu_more_options),r.onReady&&O.subscribe("onReady",r.onReady),r.onWillExecuteAction&&O.subscribe("onWillExecuteAction",r.onWillExecuteAction),r.onDidExecuteAction&&O.subscribe("onDidExecuteAction",r.onDidExecuteAction),r.onPostProcessingStyling&&O.subscribe("onPostProcessingStyling",r.onPostProcessingStyling),r.onCopy&&O.subscribe("onCopy",r.onCopy),r.onPreInit&&O.subscribe("onPreInit",r.onPreInit),g.$on(r,h.events.layout.themeChanged,function(e){return O.updateHostConfigForCurrentTheme()}),O.cardEventHandler=function(e,t){O.handleCardEvent(e,t)},O.card&&O.card.subscribeForChanges(O.cardEventHandler),O.enlargeImageLabel=l.instant(y.strings.botcards_enlarge_image),O.enableExpandingImagesInAdaptiveCards=w.valueAsBoolean(h.settings.names.enableExpandingImagesInAdaptiveCards),O.isAtMentionsEnabledInAdaptiveCards=w.valueAsBoolean(h.settings.names.enableAtMentionsAdaptiveCardsMessaging),O.emailCardImprovementsEnabled=w.valueAsBoolean(h.settings.names.enableEmailAdaptiveCardImprovements),O.emailCardHackEnabled=w.valueAsBoolean(h.settings.names.enableEmailAdaptiveCardHack),O.initializeMarkdownLibrary(),d.AdaptiveCard.useMarkdownInRadioButtonAndCheckbox=!1,d.AdaptiveCard.onProcessMarkdown=O.processMarkDown,r.$on("$destroy",function(){O.card&&O.card.unsubscribeForChanges(O.cardEventHandler)}),O}return i(t,e),t.$inject=["botCardService","uiOrchestrator","$sce","$scope","$element","$compile","$window","$cookies","$translate","$templateCache","$timeout","constants","localizationService","ariaLiveService","eventingService","botCardFactory","htmlSanitizer","resources","loggingService","utilityService","settingsService","tooltipService","tooltipCssApplicators","appsService","dialogService","semanticObjectService","htmlMessageBodyAdapterService","mruServiceV2"],Object.defineProperty(t.prototype,"adaptiveCardObject",{get:function(){return this.adaptiveCard},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adaptiveCardElement",{get:function(){return this.$element.find("."+this.cardBodyClass)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardContentElement",{get:function(){return this.$element.find(".ts-adaptive-card")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardBorderElement",{get:function(){return this.cardContentElement.find(".card-border-placeholder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appAttributionElement",{get:function(){return this.cardContentElement.find(".card-app-attribution")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardCopyElement",{get:function(){return this.$element.find(".power-bar-card-copy")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardCloseElement",{get:function(){return this.$element.find(".card-close")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardHeaderElement",{get:function(){return this.$element.find(".card-header")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardOverflowActionsElement",{get:function(){return this.$element.find(".card-overflow-actions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardCollapseElement",{get:function(){return this.$element.find(".card-collapse")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actionFeedbackElement",{get:function(){return this.$element.find(".action-feedback")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorMessageElement",{get:function(){return this.$element.find(".error-text")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"popupContainerSelector",{get:function(){return this.$scope.popupContainerSelector?this.$scope.popupContainerSelector:this.$scope.threadId?"#"+teamspace.services.MessagingUtilities.getFormattedThreadId(this.$scope.threadId):"[data-tid='"+this.dateTid+"']"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dateTid",{get:function(){return"ts-adaptive-card-"+this.objectId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return this.card.content},set:function(e){this.cardViewModel=this.botCardFactory.createCard({content:e,contentType:this.constants.bots.cards.types.adaptive},null,null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardViewModel",{get:function(){return this.card},set:function(e){this.card.unsubscribeForChanges(this.cardEventHandler),this.card=e,this.card.subscribeForChanges(this.cardEventHandler),this.initAdaptiveCard(),this.render()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCardBorder",{get:function(){return this.cardBorderElement.hasClass(this.cardBorderClass)},set:function(e){e!==this.showCardBorder&&(e?this.cardBorderElement.addClass(this.cardBorderClass):this.cardBorderElement.removeClass(this.cardBorderClass))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardBorderTopColor",{get:function(){return this.cardBorderElement[0].style.borderTopColor},set:function(e){this.cardBorderElement[0].style.borderTopColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardBorderColor",{get:function(){return this.cardBorderElement[0].style.borderColor},set:function(e){this.cardBorderElement[0].style.borderColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCopy",{get:function(){return!this.cardCopyElement.hasClass("hide")},set:function(e){e!==this.showCopy&&(e?this.cardCopyElement.removeClass("hide"):this.cardCopyElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCardHeader",{get:function(){return!this.cardHeaderElement.hasClass("hide")},set:function(e){e!==this.showCardHeader&&(e?this.cardHeaderElement.removeClass("hide"):this.cardCloseElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCardClose",{get:function(){return!this.cardCloseElement.hasClass("hide")},set:function(e){e!==this.showCardClose&&(e?this.cardCloseElement.removeClass("hide"):this.cardCloseElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCardCollapse",{get:function(){return!this.cardCollapseElement.hasClass("hide")},set:function(e){e!==this.showCardCollapse&&(e?this.cardCollapseElement.removeClass("hide"):this.cardCollapseElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showFeedback",{get:function(){return!this.actionFeedbackElement.hasClass("hide")},set:function(e){e!==this.showFeedback&&(e?this.actionFeedbackElement.removeClass("hide"):this.actionFeedbackElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorMessageText",{set:function(e){this.errorMessageElement.text(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useDefaultResponsiveCardWidth",{get:function(){return this.cardContentElement.hasClass(this.cardResponsiveWidthClass)},set:function(e){e!==this.useDefaultResponsiveCardWidth&&(e?this.cardContentElement.addClass(this.cardResponsiveWidthClass):this.cardContentElement.removeClass(this.cardResponsiveWidthClass))},enumerable:!0,configurable:!0}),t.prototype.handleAppInstall=function(e){this.openAppInstallDialog(this.card,"adaptive-card",this.constants,this.dialogService,this.loggingService,e),this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.cardHeaderMenuId)},t.prototype.handleOnCopy=function(e){var t=this.loggingService.newScenario(this.constants.scenarios.extensibility.inputExtension.cardHeaderCopy);try{this.clientObservers.onCopy&&this.clientObservers.onCopy({$ctrl:this,$event:e}),this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.cardHeaderMenuId),t.stop()}catch(e){t.fail({appId:this.card.appId,error:o.ErrorUtility.format(e)})}this.botCardService.logTelemetryForCardHeaderCopy(this.card)},t.prototype.handleCardHeaderMenu=function(e){this.openCardHeaderMenu(this.card,"lazy-components/adaptive-card/card-header-menu.html",e,this.$timeout,this.$scope,this.cardHeaderMenuId,this.tooltipService,this.tooltipCssApplicators,this.appsService,this.popoverPlacement||"auto bottom-right",this.$element)},t.prototype.handleOverflowActionsMenu=function(e){this.openCardOverflowMenu(this.card,"lazy-components/adaptive-card/card-overflow-menu.html",e,this.$timeout,this.$scope,this.cardHeaderMenuId,this.tooltipService,this.tooltipCssApplicators,this.appsService,this.popoverPlacement||"auto bottom-right",this.$element)},t.prototype.handleMenuKeyDown=function(e){e.which===this.constants.keyCodes.escape&&this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.cardHeaderMenuId)},t.prototype.postLink=function(){var e=this;if(this.$scope.payload&&(this.card&&this.card.unsubscribeForChanges(this.cardEventHandler),this.card=this.botCardFactory.createCard({content:this.$scope.payload,contentType:this.constants.bots.cards.types.adaptive},null,null),this.card&&this.card.subscribeForChanges(this.cardEventHandler)),this.card&&this.card.content){this.initAdaptiveCard();var t=angular.element(s);this.$element.empty(),this.$element.append(t),this.render(),this.showCardBorder=!angular.isDefined(this.$scope.showCardBorder)||this.$scope.showCardBorder,this.showCardBorder&&this.card.accentColor&&(this.cardBorderTopColor=this.card.accentColor),this.showCopy=!!angular.isDefined(this.$scope.showCopy)&&this.$scope.showCopy,this.showCardClose=this.isUrlPreviewCard(this.card),this.showCardCollapse=this.isUrlPreviewCard(this.card),this.initCardHeader(),this.showFeedback=!1,this.useDefaultResponsiveCardWidth=!!angular.isDefined(this.$scope.useDefaultResponsiveCardWidth)&&this.$scope.useDefaultResponsiveCardWidth,teamspace.common.SafeJQuery.on(this.$scope,this.cardCopyElement,"click",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.clientObservers.onCopy&&e.clientObservers.onCopy({$ctrl:e,$event:t[0]})}),teamspace.common.SafeJQuery.on(this.$scope,this.cardCloseElement,"click",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onRemoveCard(e.card,!1)}),teamspace.common.SafeJQuery.on(this.$scope,this.cardCollapseElement,"click",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onRemoveCard(e.card,!0)}),this.clientObservers.onReady&&this.clientObservers.onReady({$ctrl:this})}},t.prototype.render=function(){var e=this.adaptiveCard.render();this.adaptiveCardElement.empty(),this.adaptiveCardElement.append(e),this.postProcessingStyling(),this.$compile(this.cardContentElement)(this.$scope)},t.prototype.subscribe=function(e,t){this.clientObservers[e]=t},t.prototype.unsubscribe=function(e,t){delete this.clientObservers[e]},t.prototype.overwriteConfig=function(e){var t=this.adaptiveCard.hostConfig,n=_.merge(t,e);this.adaptiveCard.hostConfig=n},t.prototype.initializeMarkdownLibrary=function(){this.markdownIt=new p("zero").enable(["link","emphasis","list","newline","escape"]),h.MentionsRule.addMentionsRule(this.constants.semanticObjectSchemas.mention,this.markdownIt)},t.prototype.initCardHeader=function(){this.showCardOverflowActions=this.emailCardImprovementsEnabled&&this.card.content&&this.overflowActions&&this.overflowActions.length>0,this.showCardHeader=this.canShowCardHeader(this.card)&&!this.showCardOverflowActions&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableCardHeaderButton)},t.prototype.initAdaptiveCard=function(){var e=this;this.clientObservers.onPreInit&&this.clientObservers.onPreInit({$ctrl:this});d.AdaptiveCard.elementTypeRegistry.unregisterType("Input.Date"),d.AdaptiveCard.elementTypeRegistry.registerType("Input.Date",function(){return new u.DateInput(".ts-message-list-item",e.popupContainerSelector,e.localizationService,e.ariaLiveService,e.$scope.$new(),e.$compile,e.$translate,e.resources)}),d.AdaptiveCard.elementTypeRegistry.unregisterType("Input.Time"),d.AdaptiveCard.elementTypeRegistry.registerType("Input.Time",function(){return new u.TimeInput(".ts-message-list-item",e.popupContainerSelector,e.localizationService,e.ariaLiveService,e.$scope.$new(),e.logger,e.constants)}),d.AdaptiveCard.elementTypeRegistry.unregisterType("Input.ChoiceSet"),d.AdaptiveCard.elementTypeRegistry.registerType("Input.ChoiceSet",function(){return new u.ChoiceSetInput(".ts-message-list-item",e.popupContainerSelector,e.$scope.$new(),e.$compile,e.$templateCache,e.$translate,e.resources,e.ariaLiveService,e.objectId)}),d.AdaptiveCard.elementTypeRegistry.unregisterType("Input.Toggle"),d.AdaptiveCard.elementTypeRegistry.registerType("Input.Toggle",function(){return new u.ToggleInput(e.$templateCache,e.$translate,e.resources,e.ariaLiveService,e.objectId)});var t=this.emailCardImprovementsEnabled?this.extractOverflowActions(this.card.content):void 0;this.adaptiveCard=new d.AdaptiveCard,this.adaptiveCard.parse(this.card.content),this.emailCardImprovementsEnabled&&this.parseOverflowActions(t),this.setupHostConfig(),this.adaptiveCard.onExecuteAction=function(t){return e.handleOnExecuteAction(t)},this.adaptiveCard.onInlineCardExpanded=function(t,n){return e.handleOnInlineCardExpanded(t,n)},this.adaptiveCard.onElementVisibilityChanged=function(t){return e.handleOnElementVisibilityChanged(t)}},t.prototype.handleOnElementVisibilityChanged=function(e){var t=new teamspace.services.CardButton;t.type=this.constants.bots.cards.adaptiveCard.actions.toggleVisibility,this.botCardService.logTelementryForCardAction(this.card,t)},t.prototype.handleOnInlineCardExpanded=function(e,t){this.postProcessingStyling(),t&&e.card&&e.card.speak&&this.ariaLiveService.update(e.card.speak,!0);var n=new teamspace.services.CardButton;n.type=this.constants.bots.cards.adaptiveCard.actions.showCard,n.title=e.title,this.botCardService.logTelementryForCardAction(this.card,n)},t.prototype.extractOverflowActions=function(e){var t=this;if(e&&e.actions){var n=_.partition(e.actions,function(e){return t.emailCardHackEnabled&&t.card.appId===t.constants.appId.shareToTeamsFromOutlook?"Open in Teams"===e.title||"Download"===e.title:e.msTeams&&e.msTeams.overflow}),i=n[0]||[];return e.actions=n[1],i}},t.prototype.parseOverflowActions=function(e){var t=this,n=[];this.overflowActions=_.map(e,function(e){var i=d.createActionInstance(t.adaptiveCard,e,[],!1,n);return t.processOverflowActionIcon(i),i})},t.prototype.processOverflowActionIcon=function(e){var t,n=this.settingsService.getStaticsUri();if(e.iconUrl){e.iconUrl=e.iconUrl.trim();var i=e.iconUrl.lastIndexOf("/")+1;if(i>0&&i<e.iconUrl.length-1&&(t=e.iconUrl.substr(i)),t)switch(t=t.toLowerCase()){case"microsoft_teams_logo_refresh.ico":e.iconUrl=n+"/evergreen-assets/adaptiveemail/icon-teams.svg";break;case"downloadicon2x.png":e.iconUrl=n+"/evergreen-assets/adaptiveemail/icon-download.svg"}}},t.prototype.handleOnExecuteAction=function(e){var t=this,n=this.constants.scenarios.extensibility.bots.adaptiveCardSubmitScenarioSteps,i=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.adaptiveCardSubmitScenario);this.postProcessingStyling();var r=this.$window.event||new Event("click"),a=jQuery.event.fix(r);Object.defineProperty(a,"currentTarget",{writable:!1,value:this.mostRecentButtonClicked||a.currentTarget}),a.currentTarget||Object.defineProperty(a,"currentTarget",{writable:!1,value:r.explicitOriginalTarget});var o=function(){if(e instanceof d.OpenUrlAction)return(n=new teamspace.services.CardButton(t.utilityService.generateUUID())).type=t.constants.bots.cards.actions.openUrl,n.title=e.title,n.value=t.resolveTemplateParamsInUrl(e.url),t.buttonClicked(a,n,t.card);if(e instanceof d.SubmitAction){if(t.card.isInputExtension?!!t.card.conversationId:!!(t.card.conversationId&&t.card.replyChainId&&t.card.cardSender&&t.card.cardSender.mri)){if(!!t.embeddedMSTeamsActionType(e))return t.transformToMSTeamsAction(a,e);var n=new teamspace.services.CardButton(t.utilityService.generateUUID());return n.type=t.constants.bots.cards.actions.messageback,n.title=e.title,n.value=JSON.stringify(e.data),t.buttonClicked(a,n,t.card)}return Promise.resolve(null)}var i="[AdaptiveCardController::handleOnExecuteAction()] unsupported $action.type to execute = "+e.getJsonTypeName();return t.logger.error(i),Promise.reject(i)},s=function(r,o,s,c){t.clientObservers.onDidExecuteAction&&(i.mark(n.onDidExecuteAction),t.clientObservers.onDidExecuteAction({$ctrl:t,$action:e,$event:a,$result:r,$error:o})),e instanceof d.SubmitAction&&!c&&(t.initAdaptiveCard(),t.render()),o&&s?i.fail({error:o}):i.stop()},c=function(){i.mark(n.executeDefaultActionStart),t.logger.info("proceedWithDefaultAction"),o().then(function(e){i.mark(n.executeDefaultActionDone),s(e)}).catch(function(e){i.mark(n.executeDefaultActionFailed),s(null,e,!0,!0)})};this.clientObservers.onWillExecuteAction?(i.mark(n.onWillExecuteActionStart),(this.clientObservers.onWillExecuteAction({$ctrl:this,$action:e,$event:a})||Promise.resolve(!1)).then(function(e){i.mark(n.onWillExecuteActionDone,{continueDefault:e}),e?c():s(null,void 0,void 0,!0)}).catch(function(e){i.mark(n.onWillExecuteActionFailed),s(null,e)})):c()},t.prototype.populateAtMentionsSemanticObjects=function(e,t){var n=this.mentions||this.card.mentions;if(n&&this.doesTextHaveMentions(e)){var i=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.atMentionsInAdaptiveCard.mentionScenario);i.appendEventData({mentionsArrayLength:n.length,appId:this.card.appId});try{var r=this.getContentWithSemanticObjects(t,n);return this.markAndStopAtMentionsScenario(i,r),r}catch(e){this.logger.error("unable to create at-mentions tags: "+o.ErrorUtility.format(e)),i.fail({appId:this.card.appId,error:o.ErrorUtility.format(e)}),i=null}}return t},t.prototype.doesTextHaveMentions=function(e){return!(!e||-1===e.indexOf(this.constants.semanticObjectSchemas.mention))},t.prototype.getContentWithSemanticObjects=function(e,t){var n=this.semanticObjectService.populateSemanticObjectContent(e,t,void 0,!1,void 0);return this.isSenderUserMri()&&(n=m.BotCardMentionsHelper.addBotTagForBotCardWithMentions(n,this.constants.semanticObjectSchemas.mention)),this.htmlMessageBodyAdapterService.convert(n,!1,!1)},t.prototype.isSenderUserMri=function(){var e=SkypeX.Services.ChatServiceUtils.MriNamespace_SkypeSpacesUser;return!!(this.card.cardSender&&this.card.cardSender.mri&&this.card.cardSender.mri.startsWith(e))},t.prototype.markAndStopAtMentionsScenario=function(e,t){e&&(-1!==t.toLowerCase().indexOf("data-itemprops")?(e.mark(this.constants.scenarios.extensibility.bots.atMentionsInAdaptiveCard.mentionProcessingCompleteScenarioStep),e.stop(),this.card.hasMentions=!0):(e.mark(this.constants.scenarios.extensibility.bots.atMentionsInAdaptiveCard.mentionPropertyMissingScenarioStep),e.stop()))},t.prototype.resolveTemplateParamsInUrl=function(e){var t=e||"",n=teamspace.services.O365HttpPOST.regexForValueSubstitution,i=_.uniq(t.match(n));if(i&&i.length>0){var r={};_.each(this.adaptiveCard.getAllInputs(),function(e){var t=e.value;r[e.id]=t&&encodeURIComponent(t)}),_.forEach(i,function(e){var n=e.substring(2,e.indexOf(".value"));t=t.replace(new RegExp(e,"g"),r[n])})}return t},t.prototype.handleCardEvent=function(e,t){if(e)switch(+e){case teamspace.services.CardEvent.updateAppAttribution:this.renderAppAttrubution();break;case teamspace.services.CardEvent.updateAccentColor:this.cardBorderTopColor=this.card.accentColor;break;case teamspace.services.CardEvent.updateErrorMessage:this.showFeedback=!!t.errorMessage,this.errorMessageText=t.errorMessage}},t.prototype.setupHostConfig=function(){var e=this.defaultFontSizeAndFontWeightPayload,t=(e.fontFamily,r(e,["fontFamily"])),n={fontTypes:{default:this.defaultFontSizeAndFontWeightPayload,monospace:t},imageSizes:{small:32,medium:52,large:100},separator:{lineThickness:1},actions:{maxActions:this.constants.bots.cards.limits.maxActionButtons,buttonSpacing:8,actionsOrientation:d.Orientation.Horizontal,actionAlignment:d.ActionAlignment.Left,showCard:{actionMode:d.ShowCardActionMode.Inline,inlineTopMargin:16}},factSet:{spacing:16},spacing:{small:8,default:12,medium:16,large:20,extraLarge:24,padding:16}};this.overwriteConfig(n);var i=this.defaultFontSizeAndFontWeightPayload;this.overwriteConfig(i),this.updateHostConfigForCurrentTheme(!1)},t.prototype.updateHostConfigForCurrentTheme=function(e){void 0===e&&(e=!0);var t=this.$cookies.get(this.constants.themes.cookieName)||this.constants.themes.default,n=u.AdaptiveCardHelper.colorThemeConfig[t];switch(this.overwriteConfig(n),t){case this.constants.themes.dark:this.$scope.hostConfigDark&&this.overwriteConfig(this.$scope.hostConfigDark);break;case this.constants.themes.highContrast:this.$scope.hostConfigContrast&&this.overwriteConfig(this.$scope.hostConfigContrast);break;default:this.$scope.hostConfigDefault&&this.overwriteConfig(this.$scope.hostConfigDefault)}e&&this.render()},t.prototype.postProcessingStyling=function(){var e=this,t=this.adaptiveCardElement.children().first(),n=t.children();t.find("button.ac-pushButton").addClass("ts-btn card-common-inset-border"),t.find(".ac-container button.ac-pushButton").addClass("ts-btn-primary"),t.find("button.expandable.expanded").attr("selected","selected"),t.find("button.expandable:not(.expanded)").attr("selected",null),t.find("div.ac-media").addClass("hide-content"),n.find("button.ac-inlineActionButton").addClass("ts-btn card-common-inset-border"),n.find(".ac-container button.ac-inlineActionButton").addClass("ts-btn-primary");var i=function(t,n){t.find(n).each(function(t,n){if(n.onclick){var i=n.onclick;n.onclick=function(t){e.mostRecentButtonClicked=t.currentTarget,i(t)}}})};i(t,"button.ac-pushButton"),i(n,"button.ac-inlineActionButton"),this.emailCardImprovementsEnabled&&(this.postProcessingCardWidth(),this.initCardHeader()),this.postProcessingButtonLayout(),this.cardContentElement[0].style.backgroundColor=t[0].style.backgroundColor;var r=t.find("img");_.each(r,function(t){t.onerror=void 0,t.setAttribute("card-image-error",""),e.enableExpandingImagesInAdaptiveCards&&e.addExpandImageIcon(t)}),this.card.appId!==this.constants.appId.shareToTeamsFromOutlook&&this.card.appAttribution&&this.renderAppAttrubution(),t.find("textarea").attr("contenteditable","true"),t.find("[placeholder]").attr("ng-non-bindable",""),t.find("button.ac-pushButton").attr("ng-non-bindable",""),n.find("button.ac-inlineActionButton").attr("ng-non-bindable",""),t.find("img[alt]").attr("ng-non-bindable",""),this.adaptiveCardElement.find("[aria-label]").each(function(t,n){var i=e.htmlSanitizer.escapeAngular(n.getAttribute("aria-label"));n.setAttribute("aria-label",i)}),this.clientObservers.onPostProcessingStyling&&this.clientObservers.onPostProcessingStyling({$ctrl:this})},t.prototype.addExpandImageIcon=function(e){var t=$(e).parent().attr("class");if(!(t&&-1!==t.indexOf("ac-inlineAction")||e.width<this.adaptiveCard.hostConfig.imageSizes.medium)){var n=this.htmlSanitizer.escapeAngular(this.htmlSanitizer.sanitizePreviewUrl(e.getAttribute("src")));$('<a class="ts-sym app-icons-fill-hover card-image-expand"\n          ng-include="\'svg/icons-expand.html\'"\n          href="'+n+'"\n          title="'+this.enlargeImageLabel+'"\n          aria-label="'+this.enlargeImageLabel+'"\n          track-outcome="{{::$root.trackConstants.trackOutcome.inspect}}"\n          track-scenario="{{::$root.trackConstants.trackScenario.botClickCardAction}}"\n          track-scenario-type="{{::$root.trackConstants.trackScenarioType.other}}"\n          track-name="{{::$root.trackConstants.trackModuleName.button}}"\n          track-type="{{::$root.trackConstants.trackType.button}}"\n          track-summary="Enlarge the image on the card"\n          target="_blank"\n          ng-click="$event.stopPropagation();"\n          media-preview-enabler\n          data-allow-download="false"\n          rel="noreferrer noopener">\n          </a>').insertBefore(e),$(e).parent().wrapInner('<div class="card-enlarge-image-icon-wrapper">')}},t.prototype.postProcessingCardWidth=function(){this.emailCardHackEnabled&&this.card.appId===this.constants.appId.shareToTeamsFromOutlook?this.cardContentElement.css("width","100%"):this.card.content.msTeams&&"FULL"===_.toUpper(this.card.content.msTeams.width)&&this.cardContentElement.css("width","100%")},t.prototype.postProcessingButtonLayout=function(){var e=this,t=this.adaptiveCardElement.children().first(),n=t.children(),i=this.adaptiveCard.hostConfig.actions.buttonSpacing/2+"px",r=t.find("button.ac-pushButton"),a=n.find("button.ac-inlineActionButton"),o=function(e){return _.chain(e).map(function(e){return e.parentElement}).filter(function(e){return"flex"===e.style.display}).uniq().value()},s=o(r),c=o(a);_.each(s,function(t){var n=$(t).find("div");_.forEach(n,function(e){e.innerHTML||$(e).removeAttr("style").end().html()}),e.addButtonStyling(t,"button.ac-pushButton",i)}),_.each(c,function(t){$(t).find("input.ac-input.ac-textInput").addClass("inline-textInput"),$(t).find("textarea.ac-input.ac-textInput.ac-multiline").addClass("inline-textInput"),e.addButtonStyling(t,"button.ac-inlineActionButton",i),$(t).find("button.ac-inlineActionButton").length>0&&$(t).addClass("inline-action-input")})},t.prototype.addButtonStyling=function(e,t,n){_.forEach($(e).find(t),function(e){e.style.margin=n}),e.style.flexWrap="wrap",e.style.margin="-"+n},t.prototype.renderAppAttrubution=function(){if(this.appAttributionElement.empty(),this.card.appAttribution){var t=e.prototype.useNgIncludeForIcon.call(this,this.card.appAttribution.imageUrl)?this.$templateCache.get(this.card.appAttribution.imageUrl):'<img src="'+this.card.appAttribution.imageUrl+'"/>';this.appAttributionElement.append('\n        <div class="image-container" style="background-color: '+this.card.appAttribution.accentColor+'">\n          '+t+"\n        </div>\n        <span>"+this.card.appAttribution.name+"</span>\n      ");var n=this.adaptiveCard.hostConfig.spacing.padding+"px";this.appAttributionElement[0].style.padding=n+" "+n+" 0"}},t.prototype.embeddedMSTeamsActionType=function(e){var t=this.constants.bots.cards.adaptiveCard.teamsActionWrapperName;return e&&e.data&&e.data[t]&&e.data[t].type&&_.isString(e.data[t].type)&&e.data[t].type.toLowerCase()},t.prototype.transformToMSTeamsAction=function(e,t){var n=this,i=this.constants.bots.cards.adaptiveCard.teamsActionWrapperName,r=t.data[i],a=this.embeddedMSTeamsActionType(t),o=new teamspace.services.CardButton(this.utilityService.generateUUID());o.title=t.title;var s=function(e){var r=_.cloneDeep(t.data);delete r[i];try{var a=_.isString(e)?JSON.parse(e):e;a instanceof Object&&!(a instanceof Array)?r=_.defaults(r,a):n.logger.error("invoke payload must be an object (and array is not supported). Will ignore.")}catch(e){n.logger.error("embeddedActionValue must be either a JSON object OR stringified JSON")}return JSON.stringify(r)};switch(a.toLowerCase()){case this.constants.taskModuleConstants.invokeNames.fetch.toLowerCase():o.type=this.constants.bots.cards.actions.invoke,o.value=s(JSON.stringify({type:this.constants.taskModuleConstants.invokeNames.fetch}));break;case this.constants.bots.cards.actions.messageback.toLowerCase():o.type=this.constants.bots.cards.actions.messageback,o.displayText=r.displayText,o.text=r.text,o.value=s(r.value);break;case this.constants.bots.cards.actions.invoke.toLowerCase():o.type=this.constants.bots.cards.actions.invoke,o.value=s(r.value);break;case this.constants.bots.cards.actions.reply.toLowerCase():o.type=this.constants.bots.cards.actions.reply,o.value=r.value;break;case this.constants.bots.cards.actions.signIn.toLowerCase():o.type=this.constants.bots.cards.actions.signIn,o.value=r.value;break;default:this.logger.error("Unrecognized action type = "+a)}return o.type?this.buttonClicked(e,o,this.card):Promise.reject("Unrecognized action type = "+a)},t.botInvokeName="adaptiveCardSubmit",t}(a.BaseCardController);t.AdaptiveCardController=f,angular.module("teamspace.adaptiveCard",[]).directive("adaptiveCard",[function(){return{restrict:"E",scope:{payload:"<?",popupContainerSelector:"@?",threadId:"@?",showCardBorder:"<?",showCardHeader:"<?",showCopy:"<?",useDefaultResponsiveCardWidth:"<?",hostConfigDefault:"<?",hostConfigDark:"<?",hostConfigContrast:"<?",onReady:"&?",onWillExecuteAction:"&?",onDidExecuteAction:"&?",onPostProcessingStyling:"&?",onCopy:"&?",onPreInit:"&?",popoverPlacement:"@?"},controllerAs:"ctrl",bindToController:{card:"<?",seeMoreEnabled:"@?",mentions:"<?"},controller:f,link:function(e,t,n,i){i.postLink()}}}]).run(["$templateCache",function(e){e.put("lazy-components/adaptive-card/adaptive-card.html",s),e.put("lazy-components/adaptive-card/card-header-menu.html",c),e.put("lazy-components/adaptive-card/card-overflow-menu.html",l)}])},238:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),a=n(37),o=function(e){function t(t,n,i,r,o,s,c,l){var d=e.call(this)||this;d.popupContainerSelector=n,d.localizationService=i,d.ariaLiveService=r,d.$scope=o,d.$compile=s,d.$translate=c,d.resources=l,d.actionPrefix="actionDatepicker";var p=function(e,n){!function(e){e.css("overflow",n?"visible":"")}(e.closest(t))};return o.$on(d.actionPrefix+".show.before",function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.date=t[0].$date||new Date}),o.$on(d.actionPrefix+".show",function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=$(n[0].$element);p(r,!0),a.AdaptiveCardHelper.scrollToBottomForLastItem(r,t),d.narrateDate(),d.narrateDatepickerLabel()}),o.$on(d.actionPrefix+".hide.before",function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];p($(t[0].$element),!1),d.date=t[0].$date}),d}return i(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return'\n      <input type="text"\n              class="ac-textInput ac-dateInput"\n              ng-attr-placeholder="{{::ctrl.placeholder}}"\n              ng-model="'+this.uniqueId+'"\n              ng-change="ctrl.narrateDate()"\n              bs-datepicker\n              aria-hidden="true"\n              data-autoclose="true"\n              data-date-format="mediumDate"\n              data-container="'+this.popupContainerSelector+'"\n              data-prefix-event="'+this.actionPrefix+'"\n              data-template-url="components/date-picker/date-picker.html"/>\n    '},enumerable:!0,configurable:!0}),t.prototype.internalRender=function(){return _.isEmpty(this.defaultValue)||(this.value=this.defaultValue),this.dateInputElement=angular.element(this.template),this.$scope.ctrl=this,this.$compile(this.dateInputElement)(this.$scope),this.dateInputElement[0]},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.placeholder=t.placeholder},Object.defineProperty(t.prototype,"value",{get:function(){var e=moment(this.date||null);return e.isValid()?e.format("YYYY-MM-DD"):null},set:function(e){var t=moment(e);this.date=t.isValid()?t.toDate():null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"date",{get:function(){return this.bindingDate},set:function(e){this.$scope.$parent[this.uniqueId]=e,this.bindingDate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueId",{get:function(){return"id"+this.$scope.$id},enumerable:!0,configurable:!0}),t.prototype.narrateDate=function(){if(this.date){var e=this.localizationService.getDate(this.date,"fullDate");this.ariaLiveService.update(e,!0)}},t.prototype.narrateDatepickerLabel=function(){this.ariaLiveService.update(this.$translate.instant(this.resources.strings.meeting_datepicker_accessible_string),!0)},t}(r.Input);t.DateInput=o},239:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),a=n(37),o=function(e){function t(t,n,i,r,a,o,s){var c=e.call(this)||this;return c.messageListItemClassSelector=t,c.popupContainerSelector=n,c.localizationService=i,c.ariaLiveService=r,c.$scope=a,c.logger=o,c.constants=s,c}return i(t,e),t.prototype.internalRender=function(){var e=this;this.timeInputElement=angular.element(document.createElement("input"));var t=this.timeInputElement[0];return t.type="text",t.classList.add("ac-textInput","ac-timeInput"),t.setAttribute("aria-labelledby","starttimetitle"),t.setAttribute("aria-atomic","true"),t.setAttribute("aria-relevant","all"),this.placeholder&&(t.placeholder=this.placeholder),teamspace.common.SafeJQuery.on(this.$scope,this.timeInputElement,"focus",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onTimeFocus()}),!_.isEmpty(this.defaultValue)&&(this.value=this.defaultValue),this.timeInputElement[0]},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.placeholder=t.placeholder},Object.defineProperty(t.prototype,"value",{get:function(){if(this.timeInputElement){var e=this.timeInputElement.val();return this.timeStringFormatConvert(e,t.TimeFormatDisplay,t.TimeFormatHTML5)}return null},set:function(e){var n=this.timeStringFormatConvert(e,t.TimeFormatHTML5,t.TimeFormatDisplay);this.timeInputElement.val(n)},enumerable:!0,configurable:!0}),t.prototype.onTimeFocus=function(){var e=this,t=this.timeInputElement;if(!t.hasClass("ui-timepicker-input")){t.timepicker({showDuration:!0,timeFormat:function(t){return e.localizationService.getDate(t,"shortTime")},appendTo:t.closest(this.popupContainerSelector)});var n=function(t,n){$(t.currentTarget).closest(e.messageListItemClassSelector).css("overflow",n?"visible":"")};teamspace.common.SafeJQuery.on(this.$scope,t,"showTimepicker",function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];n(i[0],!0),a.AdaptiveCardHelper.scrollToBottomForLastItem($(i[0].currentTarget),e.messageListItemClassSelector),e.addDelayedAriaHidden(t),t.on("keydown.adaptiveCardTime",function(t){if(t.which===e.constants.keyCodes.up||t.which===e.constants.keyCodes.down){var n=e.popupContainerSelector+" .ui-timepicker-selected:visible";e.narrateSelectedTime(n)}})}),teamspace.common.SafeJQuery.on(this.$scope,t,"hideTimepicker",function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.data("timepickerList").hide(),n(e[0],!1),t.attr("aria-hidden",""),t.off("keydown.adaptiveCardTime")})}},t.prototype.timeStringFormatConvert=function(e,t,n){var i=moment(e,t);return i.isValid()&&i.format(n)||null},t.prototype.addDelayedAriaHidden=function(e){var t=this;setTimeout(function(){var n=angular.element(e);n&&n.length>0?n.attr("aria-hidden","true"):t.logger.error("[TimeInput.addDelayedAriaHidden()] Selector did not return any element: {0}",e)},1e3)},t.prototype.narrateSelectedTime=function(e){var t=this;setTimeout(function(){var n=angular.element(e),i=n[n.length-1].innerText;t.ariaLiveService.update(i,!0)})},t.TimeFormatHTML5="HH:mm",t.TimeFormatDisplay="h:mm A",t}(r.Input);t.TimeInput=o},240:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n,i,r,a){var o=e.call(this)||this;return o.$translate=n,o.resources=i,o.ariaLiveService=r,o.cardId=a,o.unselectedSvgHtml=t.get("svg/icons-checkbox-unselected.html"),o.selectedSvgHtml=t.get("svg/icons-checkbox-selected.html"),o}return i(t,e),t.prototype.internalRender=function(){var e=this;this.inputElement=document.createElement("input"),this.inputElement.type="checkbox",this.inputElement.classList.add("check-item"),this.inputElement.name=this.cardId+this.id,this.inputElement.checked=this.defaultValue&&this.valueOn&&this.defaultValue===this.valueOn;var t=angular.element('<div class="icons-item-unselected icon hide-text">'+this.unselectedSvgHtml+"</div>"),n=angular.element('<div class="icons-item-selected icon hide-text">'+this.selectedSvgHtml+"</div>");this.wrap&&(t.find("svg").addClass("wrap"),n.find("svg").addClass("wrap"));var i=angular.element(document.createElement("label"));i[0].classList.add("choice-label"),i[0].title=this.title,i[0].setAttribute("tabindex","-1"),i[0].onfocus=function(){return e.narrateFocusedItem()},i[0].onkeydown=function(t){return e.onkeydown(t)},i.append(this.inputElement),i.append(t),i.append(n),i.append(angular.element("<span ng-non-bindable>"+this.title+"</span>")),this.addWrapStyling(i);var r=angular.element(document.createElement("div"));return r.addClass("choice-container"),r.append(i),this.rootElement=angular.element(document.createElement("div")),this.rootElement.addClass("o365-action-pane-multichoice-input"),this.rootElement.append(r),this.rootElement.addClass("ac-toggleInput"),this.rootElement[0]},Object.defineProperty(t.prototype,"value",{get:function(){return this.inputElement?this.inputElement.checked?this.valueOn:this.valueOff:null},enumerable:!0,configurable:!0}),t.prototype.addWrapStyling=function(e){this.wrap&&(e.css("overflow-wrap","break-word"),e[0].style.wordBreak="break-word",e[0].style.height="auto",e[0].style.whiteSpace="unset",e[0].style.display="flex",e[0].style.alignItems="center",e[0].style.textAlign="left")},t.prototype.onkeydown=function(e){var t=teamspace.Constants.Instance.keyCodes.enter,n=teamspace.Constants.Instance.keyCodes.space;!e||e.keyCode!==t&&e.keyCode!==n||(this.inputElement&&this.inputElement.click(),this.narrateFocusedItem())},t.prototype.narrateFocusedItem=function(){var e=this.inputElement.checked?this.$translate.instant(this.resources.strings.icons_checkbox_selected):this.$translate.instant(this.resources.strings.icons_checkbox_unselected);e+=". "+this.title,this.ariaLiveService.update(e,!0)},t}(n(14).ToggleInput);t.ToggleInput=r},241:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),a=n(242),o=n(243),s=function(e){function t(t,n,i,r,a,o,s,c,l){var d=e.call(this)||this;return d.messageListItemClassSelector=t,d.popupContainerSelector=n,d.$scope=i,d.$compile=r,d.$templateCache=a,d.$translate=o,d.resources=s,d.ariaLiveService=c,d.cardId=l,d}return i(t,e),t.prototype.internalRender=function(){return this.impl.internalRender()},t.prototype.parse=function(t){e.prototype.parse.call(this,t);var n=!!t.wrap;this.impl=this.isCompact?new o.ChoiceSetCompact(this.isMultiSelect,this.choices,this.hostConfig,this.$templateCache,this.defaultValue,this.$scope,this.$compile,this.$translate,this.messageListItemClassSelector,this.popupContainerSelector,this.resources):new a.ChoiceSetExpanded(this.isMultiSelect,this.choices,this.hostConfig,this.$templateCache,this.defaultValue,this.$translate,this.resources,this.ariaLiveService,this.cardId,this.id,n)},Object.defineProperty(t.prototype,"value",{get:function(){return this.impl.value},enumerable:!0,configurable:!0}),t}(r.ChoiceSetInput);t.ChoiceSetInput=s},242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,i,r,a,o,s,c,l,d){this.isMultiSelect=e,this.choices=t,this.hostConfig=n,this.defaultValue=r,this.$translate=a,this.resources=o,this.ariaLiveService=s,this.cardId=c,this.id=l,this.wrap=d,this.inputElements=[],this.unselectedSvgHtml=e?i.get("svg/icons-checkbox-unselected.html"):i.get("svg/icons-radiobox-unselected.html"),this.selectedSvgHtml=e?i.get("svg/icons-checkbox-selected.html"):i.get("svg/icons-radiobox-selected.html")}return Object.defineProperty(e.prototype,"value",{get:function(){if(this.isMultiSelect){var e=_.filter(this.inputElements,function(e){return e.checked});return _.map(e,function(e){return e.value}).join(this.hostConfig.choiceSetInputValueSeparator)||null}var t=_.find(this.inputElements,function(e){return e.checked});return t&&t.value||null},enumerable:!0,configurable:!0}),e.prototype.internalRender=function(){var e,t=this;this.isMultiSelect&&(e=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):null);var n=angular.element(document.createElement("div"));return n.addClass("choice-container"),this.inputElements=[],_.each(this.choices,function(i,r){var a=document.createElement("input");a.type=t.isMultiSelect?"checkbox":"radio",a.classList.add("check-item"),a.name=t.cardId+t.id,a.value=i.value,a.checked=t.isMultiSelect?e&&e.indexOf(i.value)>=0:t.defaultValue&&t.defaultValue===i.value;var o=angular.element('<div class="icons-item-unselected icon hide-text">'+t.unselectedSvgHtml+"</div>"),s=angular.element('<div class="icons-item-selected icon hide-text">'+t.selectedSvgHtml+"</div>");t.wrap&&(o.find("svg").addClass("wrap"),s.find("svg").addClass("wrap"));var c=angular.element(document.createElement("label"));c[0].classList.add("choice-label"),c[0].title=i.title,c[0].setAttribute("tabindex","-1"),c[0].onfocus=function(){return t.narrateFocusedItem(r)},c[0].onkeydown=function(e){return t.onkeydown(e,a,r)},c.append(a),c.append(o),c.append(s),c.append(angular.element("<span ng-non-bindable>"+i.title+"</span>")),t.addWrapStyling(c),n.append(c),t.inputElements.push(a)}),this.choiceSetInputElement=angular.element(document.createElement("div")),this.choiceSetInputElement.addClass("o365-action-pane-multichoice-input"),this.choiceSetInputElement.append(n),this.choiceSetInputElement[0]},e.prototype.addWrapStyling=function(e){this.wrap&&(e.css("overflow-wrap","break-word"),e[0].style.wordBreak="break-word",e[0].style.height="auto",e[0].style.whiteSpace="unset",e[0].style.display="flex",e[0].style.alignItems="center",e[0].style.textAlign="left",this.isMultiSelect||(e.find("span")[0].style.paddingLeft="1.6rem"))},e.prototype.onkeydown=function(e,t,n){var i=teamspace.Constants.Instance.keyCodes.enter,r=teamspace.Constants.Instance.keyCodes.space;!e||e.keyCode!==i&&e.keyCode!==r||(t.click(),this.narrateFocusedItem(n))},e.prototype.narrateFocusedItem=function(e){var t=this.inputElements[e],n="";n=this.isMultiSelect?t.checked?this.$translate.instant(this.resources.strings.icons_checkbox_selected):this.$translate.instant(this.resources.strings.icons_checkbox_unselected):t.checked?this.$translate.instant(this.resources.strings.icons_radiobox_selected):this.$translate.instant(this.resources.strings.icons_radiobox_unselected),n+=". "+this.choices[e].title,this.ariaLiveService.update(n,!0)},e}();t.ChoiceSetExpanded=i},243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),r=function(){function e(e,t,n,r,a,o,s,c,l,d,p){var u=this;this.isMultiSelect=e,this.choices=t,this.hostConfig=n,this.$scope=o,this.$compile=s,this.$translate=c,this.popupContainerSelector=d,this.resources=p,this.showDropdown=!1;var h=function(e,t){e.closest(l).css("overflow",t?"visible":"")};o.$on("dropdown.show",function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=$(t[0].$element);h(r,!0),i.AdaptiveCardHelper.scrollToBottomForLastItem(r,l)}),o.$on("dropdown.hide.before",function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.showDropdown=!1,h($(t[0].$element),!1)}),this.dropdownSvgHtml=r.get("svg/icons-dropdown.html"),this.unselectedSvgHtml=e?r.get("svg/icons-checkbox-unselected.html"):r.get("svg/icons-radiobox-unselected.html"),this.selectedSvgHtml=e?r.get("svg/icons-checkbox-selected.html"):r.get("svg/icons-radiobox-selected.html");var m;e&&(m=a?a.split(n.choiceSetInputValueSeparator):null),this.choiceListChecked=_.map(t,function(t){return e?m&&m.indexOf(t.value)>=0:a&&a===t.value})}return Object.defineProperty(e.prototype,"value",{get:function(){var e=this.selectedItems;return this.isMultiSelect?_.map(e,function(e){return e.value}).join(this.hostConfig.choiceSetInputValueSeparator)||null:e&&e[0]&&e[0].value||null},enumerable:!0,configurable:!0}),e.prototype.internalRender=function(){return this.choiceSetInputElement=angular.element(this.dropdownTemplate),this.$scope.ctrl=this,this.$compile(this.choiceSetInputElement)(this.$scope),this.updateDropdownTextAndTitle(),this.setupClickHandlerForDropdownArrowButton(),this.choiceSetInputElement[0]},Object.defineProperty(e.prototype,"dropdownTemplate",{get:function(){return'\n      <div class="o365-action-pane-multichoice-input">\n        <div class="o365-multichoice-selector">\n          <button class="o365-text-input o365-text-input-singleline"\n                  bs-dropdown\n                  data-bs-show="ctrl.showDropdown"\n                  aria-haspopup="true"\n                  aria-expanded="false"\n                  data-placement="bottom-left"\n                  data-container="'+this.popupContainerSelector+'">\n            <div class="text"></div>\n            <div class="placeholder">'+this.dropdownPlaceholder+"</div>\n          </button>\n          "+this.choiceListTemplate+'\n          <button class="o365-dropdown-button">\n            <div aria-hidden="true">'+this.dropdownSvgHtml+"</div>\n          </button>\n        </div>\n      </div>\n    "},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"choiceListTemplate",{get:function(){var e=this,t="";return _.each(this.choices,function(n,i){t+='\n        <li class="item"\n            ng-class="{\'selected\' : ctrl.choiceListChecked['+i+']}"\n            acc-role="menu-item focus-default clickable"\n            tabindex="0">\n          <a ng-click="ctrl.onDropdownItemClicked($event, '+i+')"\n             track-click-silent="true">\n            <div class="icons-item-unselected icon hide-text">'+e.unselectedSvgHtml+'</div>\n            <div class="icons-item-selected icon hide-text">'+e.selectedSvgHtml+"</div>\n            <span ng-non-bindable>"+n.title+"</span>\n          </a>\n        </li>\n      "}),'\n      <div class="ts-adaptive-card dropdown-menu o365-multichoice-dropdown '+(this.isMultiSelect&&"isMultiselect")+'">\n        <div acc-role="menu">\n          <div class="dropdown-item-container" simple-scrollbar>\n            <ul class="dropdown-list">\n              '+t+"\n            </ul>\n          </div>\n        </div>\n      </div>\n    "},enumerable:!0,configurable:!0}),e.prototype.onDropdownItemClicked=function(e,t){this.isMultiSelect?this.toggleSelection(t):this.setSelected(t,!0),this.updateDropdownTextAndTitle(),this.isMultiSelect&&e.stopPropagation()},e.prototype.setSelected=function(e,t){this.isMultiSelect?this.choiceListChecked[e]=t:this.choiceListChecked=_.map(this.choiceListChecked,function(t,n){return n===e})},e.prototype.toggleSelection=function(e){this.setSelected(e,!this.choiceListChecked[e])},Object.defineProperty(e.prototype,"selectedItems",{get:function(){var e=this;return _.filter(this.choices,function(t,n){return e.choiceListChecked[n]})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropdownDisplayText",{get:function(){if(this.isMultiSelect){var e=this.selectedItems.length;return 0==e?null:this.$translate.instant(this.resources.strings.botcards_o365_actionCard_title_multichoice_multipleSelect_selected,{numItems:e})}return 1===this.selectedItems.length&&this.selectedItems[0].title||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropdownTooltip",{get:function(){return _.map(this.selectedItems,function(e){return e.title}).join(this.hostConfig.choiceSetInputValueSeparator+" ")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropdownPlaceholder",{get:function(){return this.isMultiSelect?this.$translate.instant(this.resources.strings.botcards_o365_actionCard_title_multichoice_multipleSelect):this.$translate.instant(this.resources.strings.botcards_o365_actionCard_title_multichoice_singleSelect)},enumerable:!0,configurable:!0}),e.prototype.toggleShowDropdown=function(){this.showDropdown=!this.showDropdown},e.prototype.updateDropdownTextAndTitle=function(){var e=this.choiceSetInputElement.find(".o365-multichoice-selector .o365-text-input"),t=e.find(".text");e.attr("title",this.dropdownTooltip),t.text(this.dropdownDisplayText);var n=this.isMultiSelect?this.dropdownDisplayText+". "+this.dropdownTooltip:this.dropdownDisplayText;e.attr("aria-label",n)},e.prototype.setupClickHandlerForDropdownArrowButton=function(){var e=this,t=this.choiceSetInputElement.find(".o365-multichoice-selector .o365-dropdown-button");teamspace.common.SafeJQuery.on(this.$scope,t,"click",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.toggleShowDropdown(),e.$scope.$apply()})},e}();t.ChoiceSetCompact=r},244:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(206),r=function(){function e(){}return e.scrollToBottomForLastItem=function(e,t){var n=e.closest(t),i=e.closest(".ts-message-list");i&&i[0]&&i.find(t).last().is(n)&&i.scrollTop(i[0].scrollHeight)},e.colorHostConfigForThemes=function(){var e=teamspace.Constants.Instance,t=i.CardCSSVariables,n={};n[e.themes.default]={containerStyles:{default:{backgroundColor:t.$appWhite.toRGBHexString(),foregroundColors:{default:{default:t.$appGray08.toARGBHexString(),subtle:t.$appGray05.toARGBHexString()},dark:{default:t.$appBlackFull.toRGBHexString(),subtle:t.$appGray08.toARGBHexString()},light:{default:t.$appWhite.toRGBHexString(),subtle:t.$appGray01.toARGBHexString()},accent:{default:t.$appBrand06.toRGBHexString(),subtle:t.$appBrand08.toRGBHexString()},attention:{default:t.$appRed05.toRGBHexString(),subtle:t.$appRed04.toRGBHexString()},good:{default:t.$appGreen06.toRGBHexString(),subtle:t.$appGreen05.toRGBHexString()},warning:{default:t.$appOrange06.toRGBHexString(),subtle:t.$appOrange05.toRGBHexString()}}},emphasis:{backgroundColor:t.$appGray14.toARGBHexString(),foregroundColors:{default:{default:t.$appGray08.toARGBHexString(),subtle:t.$appGray05.toARGBHexString()},dark:{default:t.$appBlackFull.toRGBHexString(),subtle:t.$appGray08.toARGBHexString()},light:{default:t.$appWhite.toRGBHexString(),subtle:t.$appGray01.toARGBHexString()},accent:{default:t.$appBrand06.toRGBHexString(),subtle:t.$appBrand08.toRGBHexString()},attention:{default:t.$appRed05.toRGBHexString(),subtle:t.$appRed04.toRGBHexString()},good:{default:t.$appGreen06.toRGBHexString(),subtle:t.$appGreen05.toRGBHexString()},warning:{default:t.$appOrange06.toRGBHexString(),subtle:t.$appOrange05.toRGBHexString()}}}}},n[e.themes.dark]={containerStyles:{default:{backgroundColor:t.$appGray10Darktheme.toARGBHexString(),foregroundColors:{default:{default:t.$appWhiteDarktheme.toARGBHexString(),subtle:t.$appGray02Darktheme.toARGBHexString()},dark:{default:t.$appBlackFull.toRGBHexString(),subtle:t.$appGray08.toARGBHexString()},light:{default:t.$appWhite.toRGBHexString(),subtle:t.$appGray01.toARGBHexString()},accent:{default:t.$appBrand06Darktheme.toARGBHexString(),subtle:t.$appBrand08Darktheme.toARGBHexString()},attention:{default:t.$appRed02.toARGBHexString(),subtle:t.$appRed01.toARGBHexString()},good:{default:t.$appGreen03.toARGBHexString(),subtle:t.$appGreen02.toARGBHexString()},warning:{default:t.$appOrange03.toARGBHexString(),subtle:t.$appOrange02.toARGBHexString()}}},emphasis:{backgroundColor:t.$appGray14Darktheme.toARGBHexString(),foregroundColors:{default:{default:t.$appWhiteDarktheme.toARGBHexString(),subtle:t.$appGray05.toARGBHexString()},dark:{default:t.$appBlackFull.toRGBHexString(),subtle:t.$appGray08.toARGBHexString()},light:{default:t.$appWhite.toRGBHexString(),subtle:t.$appGray01.toARGBHexString()},accent:{default:t.$appBrand06Darktheme.toARGBHexString(),subtle:t.$appBrand08Darktheme.toARGBHexString()},attention:{default:t.$appRed02.toARGBHexString(),subtle:t.$appRed01.toARGBHexString()},good:{default:t.$appGreen03.toARGBHexString(),subtle:t.$appGreen02.toARGBHexString()},warning:{default:t.$appOrange03.toARGBHexString(),subtle:t.$appOrange02.toARGBHexString()}}}}};var r=t.$appAccTextColor.toARGBHexString(),a=t.$appAccBackgroundColor.toARGBHexString();return n[e.themes.highContrast]={containerStyles:{default:{backgroundColor:a,foregroundColors:{default:{default:r,subtle:r},dark:{default:r,subtle:r},light:{default:r,subtle:r},accent:{default:r,subtle:r},attention:{default:r,subtle:r},good:{default:r,subtle:r},warning:{default:r,subtle:r}}},emphasis:{backgroundColor:a,foregroundColors:{default:{default:r,subtle:r},dark:{default:r,subtle:r},light:{default:r,subtle:r},accent:{default:r,subtle:r},attention:{default:r,subtle:r},good:{default:r,subtle:r},warning:{default:r,subtle:r}}}}},n},e.colorThemeConfig=e.colorHostConfigForThemes(),e}();t.AdaptiveCardHelper=r},245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.findMentionsTag=function(t,n){if(!e.doesTextStartWithOpenTag(t,e.spanTagText,n))return{isTagMatched:!1,matchedTagText:null,matchedTagEndPosition:0};var i=n+e.openSpanTagText.length,r=t.toLowerCase().indexOf(e.endSpanTagText,i);if(-1===r)return{isTagMatched:!1,matchedTagText:null,matchedTagEndPosition:0};var a=r+e.endSpanTagText.length;return{isTagMatched:!0,matchedTagText:t.slice(n,a),matchedTagEndPosition:a}},e.doesTextStartWithOpenTag=function(e,t,n){if(60!==e.charCodeAt(n))return!1;n++;for(var i=0;i<t.length;i++){if(e.charAt(n)!==t.charAt(i).toLowerCase()&&e.charAt(n)!==t.charAt(i).toUpperCase())return!1;n++}return!0},e.getHtmlMentionElement=function(t,n,i){var r=i.parseDOM(n);return i.DomUtils.getElementsByTagName(e.spanTagText,r).filter(function(e){return e.attribs&&e.attribs.itemtype&&e.attribs.itemtype===t})[0]},e.createHtmlMentionsToken=function(t,n,i){var r=n.push("mentions",e.spanTagText,0);r.attrs=[],Object.keys(t.attribs).forEach(function(e){r.attrs.push([e,t.attribs[e]])}),r.content=i.DomUtils.getInnerHTML(t)},e.openSpanTagText="<span",e.endSpanTagText="</span>",e.spanTagText="span",e.addMentionsRule=function(t,n){var i=e.getMentionsRule(t);n.inline.ruler.before("link","mentions",i,{alt:[]});var r=e.getMentionsRenderRule(n);n.renderer.rules.mentions=r},e.getMentionsRule=function(t){return function(n){var i=e.findMentionsTag(n.src,n.pos),r=i.isTagMatched,a=i.matchedTagText,o=i.matchedTagEndPosition;if(!r)return!1;var s=window.htmlparser2,c=e.getHtmlMentionElement(t,a,s);return!!c&&(e.createHtmlMentionsToken(c,n,s),n.pos=o,!0)}},e.getMentionsRenderRule=function(t){return function(n,i){var r=n[i],a=e.openSpanTagText+t.renderer.renderAttrs(r)+">";return(a=a.replace(/&amp;/gi,"&"))+t.utils.escapeHtml(n[i].content)+e.endSpanTagText}},e}();t.MentionsRule=i},37:function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(237)),i(n(238)),i(n(239)),i(n(240)),i(n(241)),i(n(244))}},[2355]);